# 2022.03.06

ì˜¤ëŠ˜ì€ ReturnPxë¼ëŠ” í´ë˜ìŠ¤ë¥¼ êµ¬í˜„í–ˆë‹¤. 

í™”ë©´ ë ˆì´ì•„ì›ƒì„ êµ¬ì„±í•˜ê±°ë‚˜, ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ë©´ì„œ ì½”ë“œë¡œ UIì˜ ì‚¬ì´ì¦ˆë¥¼ ì§€ì •í•˜ëŠ” ê²½ìš°ê°€ ì¢…ì¢… ë“±ì¥í•œë‹¤. 

ì´ë•Œ ë§ˆë‹¤ DisplayMetrics ê°ì²´ ë¶€ë¥´ê³ ,  ë³€í™˜ ì½”ë“œ ì‘ì„±í•˜ëŠ” ê²ƒì´ ë„ˆë¬´ ë²ˆê±°ë¡­ê³ , ê·€ì°®ì•„ì„œ ë°”ë¡œ ì œê³µê°€ëŠ¥í•˜ë„ë¡ ì •ë¦¬ë¥¼ í•´ì•¼ê² ë‹¤ëŠ” ìƒê°ì„ ê³„ì† í–ˆì—ˆë‹¤. í•˜ì§€ë§Œ ë‹¹ì¥ ì‚¬ìš©í•  ì¼ì´ ì—†ì–´ì„œ ì¡°ê¸ˆì”© ë¯¸ë¤„ì™”ì—ˆëŠ”ë°, ì˜¤ëŠ˜ ë§ˆì¹¨ ë³€í™˜ ì½”ë“œê°€ í•„ìš”í•´ ì •ë¦¬ë¥¼ í•´ë²„ë ¸ë‹¤. 

```java
public class ReturnPx {

    private int dp;
    private Activity activity;

    public ReturnPx(int dp, Activity activity) {
        this.dp = dp;
        this.activity = activity;
    }

    public int returnPx(){
        DisplayMetrics displayMetrics = new DisplayMetrics();
        this.activity.getWindowManager().getDefaultDisplay().getMetrics(displayMetrics);
        float density = displayMetrics.density;

        return (int)(dp * density + 0.5f);
    }
}
```

ìƒì„±ì í˜¸ì¶œ ì½”ë“œ

```java
ItemTouchHelper helper = new ItemTouchHelper(new SwipeHelperCallback(getActivity()));
```

ë©”ì„œë“œ í˜¸ì¶œ ì½”ë“œ

```java
private final float exitWidth;

public SwipeHelperCallback(Activity activity) {
    exitWidth = new ReturnPx(72,activity).returnPx();
}
```
    

---

### # View ê³ ì •

swipeë¥¼ ì§„í–‰í•´ë„ swipeë¡œ ì¸ì‹í•˜ì§€ ëª»í•˜ê³ , ë‹¤ì‹œ ìœ„ì˜ viewê°€ ë˜ëŒì•„ì˜¤ëŠ” ë¬¸ì œê°€ ìˆì—ˆë‹¤. 

```java
@Override
    
public float getSwipeThreshold(@NonNull RecyclerView.ViewHolder viewHolder) {
        boolean isClamp = getTag(viewHolder);
        setTag(viewHolder, !isClamp && currentDx <= -exitWidth );
        return .3f;    
}
```

> onDraw()ê°€ ëë‚˜ê³ , ìœ ì˜ë¯¸í•œ swipeë¥¼ í–ˆì„ ë•Œ, í˜¸ì¶œë˜ëŠ” ë©”ì„œë“œ..

â†’ ê³ ì • ìƒíƒœë¥¼ í‘œí˜„í•´ì£¼ëŠ” ì—­í•     


 `getSwipeThreshold()` ì—ì„œ ë‚´ê°€ ì°©ê°í•œ ë¶€ë¶„ì´ ìˆì—ˆê¸° ë•Œë¬¸ì´ë‹¤.  

<aside>
   

    ğŸ‘‰ğŸ» **getSwipeThreshold()**


    Returns the fraction that the user should move the View to be considered as swiped. The fraction is calculated with respect to RecyclerView's bounds.


    Default value is .5f, which means, to swipe a View, user must move the View at least half of RecyclerView's width or height, depending on the swipe direction.

</aside>

=> ì‚¬ìš©ìì˜ swipe ì§„í–‰ ì •ë„ì— ë”°ë¼, swipeë¡œ ê³ ë ¤í• ì§€ ë§ì§€ì— ëŒ€í•´ ê²°ì •í•œë‹¤ëŠ” ëœ»ì´ë‹¤.    


â—ì‹œì‘ì ì„ ê¸°ì¤€ìœ¼ë¡œ ë¹„ìœ¨ì„ íŒë‹¨í•˜ëŠ” ê²ƒì´ì§€, ë‹¨ìˆœí•˜ê²Œ RecyclerView width ì ˆë°˜ì„ ë„˜ì—ˆë‹¤ê³  ë‹¤ swipeë¡œ ì¸ì‹í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë‹¤.    

#

```java
@Override
    public void onChildDraw(@NonNull Canvas c, @NonNull RecyclerView recyclerView, @NonNull RecyclerView.ViewHolder viewHolder,
                            float dX, float dY, int actionState, boolean isCurrentlyActive) {

        if(actionState == ItemTouchHelper.ACTION_STATE_SWIPE){
            if(dX < 0) {  //ì˜¤ë¥¸ìª½ swipe
                View view = ((ZatchChatListAdapter.ViewHolder) viewHolder).itemView;
                boolean isClamp = getTag(viewHolder);
                float x = calculateDxSize(view,dX,isClamp,isCurrentlyActive);
                currentDx = x;
                getDefaultUIUtil().onDraw(c, recyclerView, getView(viewHolder),x,dY,actionState,isCurrentlyActive);
            }
        }
    }
```

ìµœëŒ€í•œ ì½”ë“œ ì°¸ê³ ë¥¼ ì•ˆí•˜ê³ , ìŠ¤ìŠ¤ë¡œ êµ¬í˜„í•´ë³´ë ¤ê³  í–ˆë‹¤ê°€ ë„ì €íˆ ì•„ì´ë””ì–´ê°€ ë– ì˜¤ë¥´ì§ˆ ì•Šì•˜ë˜ ë¶€ë¶„ì´ë‹¤.    


ì–´ë ¤ì› ë˜ ì ì€ ì¡°ê±´ë¬¸ ê²€ì‚¬ë¥¼ í†µí•´  `onDraw()` ë¥¼ ì§„í–‰í•˜ë ¤ê³  í•˜ë‹¤ë³´ë‹ˆ, ëšëš ëŠê¸°ëŠ” í˜„ìƒì´ ë°œìƒí•œ ê²ƒì´ë‹¤. 


ê·¸ë¦¬ê³  exitWidthë³´ë‹¤ dXê°’ì´ í° ê²½ìš°ì—ë„ ì¡°ê±´ë¬¸ ì½”ë“œë¥¼ ì˜ëª»ì§œì„œ exitWidth ë’¤ë¡œ viewê°€ swipe ë˜ì§€ ì•ŠëŠ” í˜„ìƒì´ ë°œìƒí•œ ê²ƒì´ì—ˆë‹¤. 


onChildDraw()ì˜ ê²½ìš°, swipeê°€ ë©ˆì¶œ ë•Œ ë°œìƒí•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ì‚¬ìš©ìê°€ viewë¥¼ ì´ë™ì‹œí‚¤ëŠ” ìˆœê°„ë§ˆë‹¤ ì—°ì†ì ìœ¼ë¡œ ê³„ì† ë©”ì„œë“œê°€ í˜¸ì¶œë˜ê¸° ë•Œë¬¸ì—, ë‹¨ìˆœíˆ ì¡°ê±´ë¬¸ì„ í†µí•´ êµ¬í˜„í•˜ëŠ” ê²ƒì´ ì í•©í•˜ì§€ ì•Šë‹¤ëŠ” ê²ƒì„ ê¹¨ë‹¬ì•˜ë‹¤.    


```java
private float calculateDxSize(View view, float dX, boolean isClamp, boolean isCurrnetlyActive){

        float max = (float)-view.getWidth() / 2; //view swipe ìµœëŒ€ ë²”ìœ„
        float x; //ê° ì¼€ì´ìŠ¤ì— ëŒ€í•´ ë™ì¼í•œ ë³€ìˆ˜ì— ë‹´ê¸°ìœ„í•œ..
        if(isClamp){
            if(isCurrnetlyActive)
                x = dX - exitWidth; //ê³ ì •ë˜ì–´ ìˆëŠ” ìƒíƒœì—ì„œ ì¶”ê°€ë¡œ swipeì‹œ, ê·¸ì— ë§ê²Œ ì´ë™ê°€ëŠ¥í•˜ê²Œí•¨
            else
                x = -exitWidth;
        }else
            x = dX; //ê³ ì • ë˜ì–´ìˆì§€ ì•Šì„ë•Œ, dXê°’ ê·¸ëŒ€ë¡œ ì „ë‹¬

        return Math.min(Math.max(max, x), 0f);  //í˜„ì¬ ìœ„ì˜ ë³€ìˆ˜ë“¤ ì „ë¶€ (-)ìƒíƒœ ëª…ì‹¬  
}
```

 

> ìœ„ì˜ ì½”ë“œì™€ ê°™ì´, ê³„ì† ì—°ì†í•´ì„œ ê°’ì´ ì „ë‹¬ë˜ë„ë¡ êµ¬í˜„í•´ì£¼ì–´ì•¼ í–ˆìŒ
