# 2022.03.04

## **ì±„íŒ… ì„œë¹„ìŠ¤ êµ¬í˜„**

ì˜¤ëŠ˜ì€ ì±„íŒ…ë°©ì— ê°¤ëŸ¬ë¦¬ì™€ ì¹´ë©”ë¼ë¥¼ ì—°ê²°ì‹œí‚¤ê³ , ì´í›„ ì±„íŒ…ë°© ë©”ì‹œì§€ë¡œ ë³´ë‚´ëŠ” ê²ƒê¹Œì§€ êµ¬í˜„ì„ í•˜ì˜€ë‹¤. 

ê°¤ëŸ¬ë¦¬, ì¹´ë©”ë¼ ê¶Œí•œ ì œì–´ ë° ê²°ê³¼ê°’ ë°˜í™˜ì€ ì´ì „ì— ì¬ì¹˜ ë“±ë¡ì—ì„œ ë¯¸ë¦¬ ì½”ë“œë¥¼ ì§œë†¨ì—ˆê¸° ë•Œë¬¸ì—, ê¸°ì¡´ ì½”ë“œë¥¼ ì°¸ê³ í•˜ë©´ì„œ ë³µìŠµí•˜ëŠ” ì •ë„ë¡œ ì§„í–‰ëë‹¤. 

ì´ì „ì— í…ìŠ¤íŠ¸ ë©”ì‹œì§€ê°€ ì „ì†¡ë˜ì—ˆì„ ë•Œ, í™”ë©´ì— ì¶œë ¥ë˜ëŠ” ê²ƒê¹Œì§€ëŠ” êµ¬í˜„ì„ í•´ë†“ì€ ìƒíƒœì˜€ëŠ”ë°, ì´ë¯¸ì§€ ë©”ì‹œì§€ë¥¼ ì „ì†¡í•˜ë ¤ê³  í•˜ë‹ˆê¹Œ í…ìŠ¤íŠ¸í•˜ê³ ëŠ” ë‹¤ë¥¸ ë°©ì‹ìœ¼ë¡œ ì§„í–‰ì´ í•„ìš”í•  ê²ƒ ê°™ì•„, ìƒˆë¡œìš´ ë ˆì´ì•„ì›ƒ ì•„ì´í…œê³¼ í•¨ìˆ˜ ë“±ì„ ìƒì„±í•´ ê¸°ëŠ¥ êµ¬í˜„ì„ ì§„í–‰í–ˆë‹¤. 

ì±„íŒ… ì„œë¹„ìŠ¤ì—ì„œ

1. ìˆ˜ì‹ ì‚¬/ë°œì‹ ì, ì´ë¯¸ì§€/í…ìŠ¤íŠ¸ì— ë”°ë¥¸ í™”ë©´ ì¶œë ¥ì„ ì–´ë–»ê²Œ ë‹¤ë¥´ê²Œ í•˜ëŠ”ì§€
2. 1ì˜ ë‚´ìš©ì„ ì–´ë–¤ êµ¬ì¡°ë¡œ ì§œê³ , ì½”ë“œë¡œ êµ¬í˜„í•´ì•¼ í•˜ëŠ”ì§€ 
3. ì±„íŒ… ë°ì´í„° í´ë˜ìŠ¤ êµ¬í˜„ 

í•´ë‹¹ ë¶€ë¶„ë“¤ì— ëŒ€í•´ ì •ë¦¬ê°€ í•„ìš”í•  ê²ƒ ê°™ì•„ì„œ ì´ ë¶€ë¶„ì„ ë³µê¸°í•˜ë©° ì •ë¦¬í•´ë³´ê³ ì í•œë‹¤. 

---

### #1 ìˆ˜ì‹ ì‚¬/ë°œì‹ ì, ì´ë¯¸ì§€/í…ìŠ¤íŠ¸ì— ë”°ë¥¸ í™”ë©´ ì¶œë ¥ì„ ì–´ë–»ê²Œ ë‹¤ë¥´ê²Œ í•˜ëŠ”ì§€

â†’ onCreateViewHolderë‚´ viewType ë§¤ê°œë³€ìˆ˜ ì‚¬ìš©

ì‚¬ì‹¤ 2ì™€ ì—°ê²°ë˜ëŠ” ë¶€ë¶„ì´ë‹¤. 1ê³¼  2ë¥¼ ê°™ì´ ê³ ë ¤í•´ì•¼ë§Œ í•œë‹¤. 

```java
@Override
    public RecyclerView.ViewHolder onCreateViewHolder(ViewGroup viewGroup, int viewType) {

        View view;

        if(viewType == ChatType.LEFT_MESSAGE){
            view = LayoutInflater.from(viewGroup.getContext()).inflate(R.layout.item_chat_left, viewGroup, false);
            return new LeftMessageViewHolder(view);
        }else if(viewType == ChatType.RIGHT_MESSAGE){
            view = LayoutInflater.from(viewGroup.getContext()).inflate(R.layout.item_chat_right, viewGroup, false);
            return new RightMessageViewHolder(view);
        }else if(viewType == ChatType.LEFT_IMAGE){
            view = LayoutInflater.from(viewGroup.getContext()).inflate(R.layout.item_chate_image_left, viewGroup, false);
            return new LeftImageViewHolder(view);
        }else{
            view = LayoutInflater.from(viewGroup.getContext()).inflate(R.layout.item_chat_image_right, viewGroup, false);
            return new RightImageViewHolder(view);
        }
    }
```

`onCreateViewHolder` ì—ì„œ `viewType`ì€  `getItemViewType` ë©”ì„œë“œë¥¼ í†µí•´ ì „ë‹¬ë˜ëŠ” ê²ƒì´ë‹¤. 

```java
@Override
    public int getItemViewType(int position) {
        super.getItemViewType(position);
        return chatItem.get(position).getViewType();
    }
```

`getItemViewType`ì˜ ë©”ì„œë“œì˜ ë§¤ê°œë³€ìˆ˜ë¥¼ ë³´ë©´, ì „ë‹¬ ë°›ì€ ë°ì´í„°ì˜ indexë¥¼ ëœ»í•˜ëŠ” `position`ì„ ë„˜ê²¨ì¤€ë‹¤. 

ì¦‰, adapterì— ì „ë‹¬í•˜ëŠ” ë°ì´í„°ê°€ viewTypeì— ëŒ€í•œ ì •ë³´ë„ í¬í•¨í•˜ê³  ìˆìœ¼ë©´ ëœë‹¤ëŠ” ëœ»ì´ë‹¤. 

```java
public class ChatType {
		public static final int LEFT_MESSAGE = 1;
    public static final int RIGHT_MESSAGE = 2;
    public static final int LEFT_IMAGE = 3;
    public static final int RIGHT_IMAGE = 4;
}
```

viewTypeì— ëŒ€í•œ ì •ë³´ëŠ” ì¶”ê°€ë¡œ í´ë˜ìŠ¤ë¥¼ êµ¬í˜„í•´, í•„ìš”í•œ typeë§Œí¼ ì›í•˜ëŠ” ì •ìˆ˜ê°’ìœ¼ë¡œ í• ë‹¹í•´ì£¼ë©´ ëœë‹¤. 

---

### #2 '1'ì˜ ë‚´ìš©ì„ ì–´ë–¤ êµ¬ì¡°ë¡œ ì§œê³ , ì½”ë“œë¡œ êµ¬í˜„í•´ì•¼ í•˜ëŠ”ì§€

â†’ RecyclerView Adapter ë‚´ ê°ê° ë‹¤ë¥¸ ViewHolder ìƒì„±

`onCreateViewHolder` ì—ì„œ ìƒí™©ì— ë§ëŠ” ViewHolder í´ë˜ìŠ¤ë¥¼ í˜¸ì¶œí•´ ìƒì„±í•˜ë©´, ì´í›„ ë°ì´í„° bindingì„ ì§„í–‰í•˜ê²Œ ëœë‹¤. 

```java
@Override
    public void onBindViewHolder(RecyclerView.ViewHolder viewHolder, final int position) {

        if(viewHolder instanceof LeftMessageViewHolder)
            ((LeftMessageViewHolder)viewHolder).setItem(chatItem.get(position));
        else if(viewHolder instanceof RightMessageViewHolder)
            ((RightMessageViewHolder)viewHolder).setItem(chatItem.get(position));
        else if(viewHolder instanceof RightMessageViewHolder)
            ((LeftImageViewHolder)viewHolder).setItem(chatItem.get(position));
        else
            ((RightImageViewHolder)viewHolder).setItem(chatItem.get(position));
    }
```

`onBindViewHolder` ë©”ì„œë“œì—ì„œ `viewHolder` ë§¤ê°œë³€ìˆ˜ë¥¼ ì‚¬ìš©í•´ ì–´ëŠ í´ë˜ìŠ¤ì—ì„œ ë„˜ì–´ì˜¨ ê²ƒì¸ì§€ë¥¼ í™•ì¸í•œë‹¤. 

<aside>


	â— ê° viewHolder í´ë˜ìŠ¤ì˜ setItem() ë©”ì„œë“œ ì£¼ëª©


	â†’ ë°ì´í„° bindingì„ onBindViewHolder ë©”ì„œë“œì—ì„œ êµ¬í˜„í•˜ëŠ” ê²ƒì´ ì•„ë‹Œ, ê° viewHolder í´ë˜ìŠ¤ì— setItem()ë©”ì„œë“œë¥¼ êµ¬í˜„í•´ ì•„ì´í…œì„ ë„˜ê²¨ì£¼ê³ , 
	ê° í´ë˜ìŠ¤ì—ì„œ bindingë˜ë„ë¡ ì½”ë“œ êµ¬í˜„

	> ì‚¬ì‹¤ ë°ì´í„° bindingì— ëŒ€í•´ ê¸°ì¡´ì— ê³„ì† í•´ë‹¹ ë©”ì„œë“œë‚´ì—ì„œ ì²˜ë¦¬í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ êµ¬í˜„ì„ í–ˆì—ˆë‹¤. 

	í•˜ì§€ë§Œ ê° viewHolderí´ë˜ìŠ¤ì—ì„œ êµ¬í˜„í•¨ì— ë”°ë¼ uiìš”ì†Œ ì ‘ê·¼ë„ ë” ê°„ë‹¨í•˜ê²Œ í•  ìˆ˜ ìˆê³ , onBindViewHolder ë©”ì„œë“œ ë‚´ì˜ ì½”ë“œ ê¸¸ì´ë„ í™•ì‹¤íˆ ì¤„ì¼ ìˆ˜ ìˆê¸° ë•Œë¬¸ì— 
	ë” ì¢‹ì€ ë°©ì‹ì´ë¼ ìƒê°ë˜ì–´ ì˜ˆì œ ì½”ë“œë¥¼ ë°˜ì˜í•˜ê²Œ ë˜ì—ˆë‹¤.

</aside>

```java
public class RightMessageViewHolder extends RecyclerView.ViewHolder {

        private final TextView message, time;

        public RightMessageViewHolder(View view) {
            super(view);
            this.message = (TextView) view.findViewById(R.id.myChat);
            this.time = (TextView) view.findViewById(R.id.myChatTime);
        }

        public void setItem(ChatItemData data) {
            if(type.equals(Chat.Gatch))
                message.setBackground(context.getDrawable(R.drawable.drawable_chat_gatch_right));
            this.message.setText(data.getContent());
            this.time.setText(data.getTimeText());
        }
    }
```

```java
public class RightImageViewHolder extends RecyclerView.ViewHolder {

        private final TextView time;
        private final ImageView image;

        public RightImageViewHolder(View view) {
            super(view);
            this.time = (TextView) view.findViewById(R.id.imageMyChatTime);
            this.image = (ImageView) view.findViewById(R.id.imageMyChatImage);
        }

        public void setItem(ChatItemData data) {
            this.time.setText(data.getTimeText());
            MultiTransformation option = new MultiTransformation(new CenterCrop(), new RoundedCorners(8));
            Glide.with(context)
                    .load(data.getContent())
                    .apply(RequestOptions.bitmapTransform(option))
                    .into(image);

        }
    }
```

imageì˜ ê²½ìš°, corner radius ì ìš©ì´ í•„ìš”í–ˆê¸° ë•Œë¬¸ì— Glide ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•´ ì´ë¯¸ì§€ë¥¼ ë„£ì–´ì£¼ê²Œ ë˜ì—ˆë‹¤. 

---

### #3 ì±„íŒ… ë°ì´í„° í´ë˜ìŠ¤ êµ¬í˜„

â†’ ì±„íŒ… RecyclerView Itemì˜ Data í´ë˜ìŠ¤ ìƒì„± 

â—ì„œë²„ì— ë„˜ê²¨ì¤„ ë•Œ ì‚¬ìš©í•˜ëŠ” ë°ì´í„° í´ë˜ìŠ¤ì™€, ë ˆì´ì•„ì›ƒì„ êµ¬ì„±í•˜ê¸° ìœ„í•œ itemì˜ ë°ì´í„° í´ë˜ìŠ¤ëŠ” ë‹¤ë¥¼ ìˆ˜ ìˆë‹¤

```java
public class ChatItemData {
    
    private String userName;
    private String content;
    private long time;
    private Uri userImage;
    private int viewType;
    private final SimpleDateFormat format = new SimpleDateFormat("HH:mm");

    public ChatItemData(String userName, String content, long time, Uri userImage, int viewType) {
        this.userName = userName;
        this.content = content;
        this.time = time;
        this.userImage = userImage;
        this.viewType = viewType;
    }

    public String getTimeText() {
        return format.format(this.time);
    }
}
```

<aside>
	
	ğŸ’¡ getTimeText()      

	>ì´ì „ì— ios ë¶€ìŠ¤íŠ¸ ì½”ìŠ¤ ê°•ì˜ë¥¼ ìˆ˜ê°•í•˜ë©´ì„œ ë°°ìš´ ë°©ì‹ì„ ì‘ìš©í•œ ê²ƒì´ë‹¤.

	ë°ì´í„° í´ë˜ìŠ¤ì—ì„œ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” ë¶€ë¶„ì€ ë°ì´í„° í´ë˜ìŠ¤ë‚´ì—ì„œ ì²˜ë¦¬í•˜ìëŠ” ìƒê°

	long íƒ€ì…ì˜ time ë°ì´í„°ë¥¼ activity ë‚´ì—ì„œ â€˜HH:mmâ€™ í˜•ì‹ìœ¼ë¡œ ë°”ê¿”ì£¼ëŠ” ê²ƒì´ ì•„ë‹Œ, ë°ì´í„° í´ë˜ìŠ¤ì—ì„œ ë°”ë¡œ ì œê³µë˜ë„ë¡ êµ¬í˜„í–ˆë‹¤.
	â†’ ì±„íŒ… activityì—ì„œ ì œê³µí•´ì•¼ í•  ë¶€ë¶„ ì¤„ì¼ ìˆ˜ ìˆìŒ

</aside>   

# 
@ ì°¸ê³     

[https://velog.io/@dongchyeon/ì•ˆë“œë¡œì´ë“œ-socket.ioë¥¼-ì´ìš©í•œ-ê°„ë‹¨í•œ-ì±„íŒ…-ì–´í”Œ-ë§Œë“¤ì–´ë³´ê¸°-3](https://velog.io/@dongchyeon/%EC%95%88%EB%93%9C%EB%A1%9C%EC%9D%B4%EB%93%9C-socket.io%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EA%B0%84%EB%8B%A8%ED%95%9C-%EC%B1%84%ED%8C%85-%EC%96%B4%ED%94%8C-%EB%A7%8C%EB%93%A4%EC%96%B4%EB%B3%B4%EA%B8%B0-3)
